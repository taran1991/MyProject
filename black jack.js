<meta charset = "utf-8">
<script>

// generates a number in a given range
function getRandomInt(min, max){
	return Math.floor(Math.random() * (max - min + 1)) + min;
}

// generates card
function getCard() {
	var cards = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A' ];
	return cards[getRandomInt(0, cards.length - 1)];
}

// counts the amount of points
function getSum(arr){
	summ = 0;
	for (i=0; i<arr.length; i++){
		if (arr[i] != 'A'){
			if (arr[i] == 'J' || arr[i] == 'Q' || arr[i] == 'K') {
				summ += 10;
			} else{
				summ += parseInt(arr[i]);
			}
		} else if (sum <= 10) {
			summ += 11;
		} else {
			summ += 1;
		}
 	}
	return summ
}

// shows the status of the game
function getStatus(){
	return 'Диллер ' + dealer.join(' ') + ' Игрок ' + player.join(' ') + '.'
}

// test amount of cards (number of cards with the same suit <= 4)
function testAmountCard(card){
	summ = 0
	for (i=0; i<player.lenght; i++) {
		if (card = player[i]){
			summ += 1;
		}
	}
	for (i=0; i<dealer.lenght; i++) {
		if (card = dealer[i]){
			summ += 1;
		}
	}

	if (summ <= 4) {
		return true
	}else{
		return false
	}

}

do {

	game = prompt('Do you want to play to Black Jack. 1-Yes 2-No');

	if (game == '1') {
		var dealer = [getCard()];
		var player = [getCard(), getCard()];
		var answer = ''

		if (getSum(player) == 21){
			alert('Black Jack!')
		} else{
			do {
				answer = prompt(getStatus() + ' One more card? 1-Yes 2 -No'); 
				if (answer == '1') {
					card = getCard();
					while (!testAmountCard(card)) {
						card = getCard()
					}
					player.push(card);
					if (getSum(player) > 21) {
						alert('You Lose. ' + getStatus());
						break
					} else if (getSum(player) == 21) {
						alert('You win! Black Jack. ' + getStatus())
						break
					} 
				}
			} while(answer == '1')

			while (getSum(dealer) < 17){
				card = getCard();
				while (!testAmountCard(card)) {
					card = getCard();
				}
				dealer.push(card);
			}

			if (getSum(dealer) > 21) {
				alert('Dealer Lose. ' + getStatus());
			} else if (getSum(dealer) == 21) {
				alert('Dealer win. Black Jack! ' + getStatus());
			} else if (getSum(dealer) > getSum(player)) {
				alert('Dealer win. ' + getStatus());
			} else if (getSum(dealer) < getSum(player)) {
				alert('Player win. ' + getStatus());
			} else {
				alert('Dead Heat!');
			}		
		}
	} else {
		alert('GoodBuy');
	}
} while(game == '1')


</script>
